{% extends 'base.html' %}
{% block title %}Transactions{% endblock %}
{% block content %}
<h1 class="text-3xl font-semibold mb-6">Transactions</h1>
<form method="get" class="grid md:grid-cols-6 gap-4 bg-white dark:bg-slate-800 p-4 rounded shadow mb-6 text-sm">
  <div>
    <label class="block mb-1">Start</label>
    <input type="date" name="start" value="{{ filters.start }}" class="w-full px-2 py-1 border rounded dark:bg-slate-700 dark:border-slate-600">
  </div>
  <div>
    <label class="block mb-1">End</label>
    <input type="date" name="end" value="{{ filters.end }}" class="w-full px-2 py-1 border rounded dark:bg-slate-700 dark:border-slate-600">
  </div>
  <div>
    <label class="block mb-1">Type</label>
    <select name="type" class="w-full px-2 py-1 border rounded dark:bg-slate-700 dark:border-slate-600">
      <option value="" {% if not filters.type %}selected{% endif %}>All</option>
      <option value="income" {% if filters.type == 'income' %}selected{% endif %}>Income</option>
      <option value="expense" {% if filters.type == 'expense' %}selected{% endif %}>Expense</option>
    </select>
  </div>
  <div>
    <label class="block mb-1">Category</label>
    <select name="category" class="w-full px-2 py-1 border rounded dark:bg-slate-700 dark:border-slate-600">
      <option value="">All</option>
      {% for c in categories %}
        <option value="{{ c.id }}" {% if filters.category == c.id|stringformat:'s' %}selected{% endif %}>{{ c.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div>
    <label class="block mb-1">Search</label>
    <input type="text" name="q" value="{{ filters.q }}" placeholder="Notes or category" class="w-full px-2 py-1 border rounded dark:bg-slate-700 dark:border-slate-600">
  </div>
  <div class="flex items-end"><button class="w-full bg-primary text-white py-2 rounded hover:bg-blue-600">Apply Filter</button></div>
</form>
<div class="bg-white dark:bg-slate-800 rounded shadow overflow-hidden">
  <table class="w-full text-sm">
  <thead><tr class="bg-slate-100 dark:bg-slate-700 text-left text-xs uppercase tracking-wide text-slate-600 dark:text-slate-300"><th class="p-2">Date</th><th class="p-2">Type</th><th class="p-2">Category</th><th class="p-2">Amount</th><th class="p-2">Notes</th><th class="p-2">Actions</th></tr></thead>
    <tbody>
      {% for t in page_obj %}
      <tr class="border-t dark:border-slate-700">
        <td class="p-2">{{ t.date }}</td>
  <td class="p-2">{% if t.type == 'income' %}<span class="badge badge-income">Income</span>{% else %}<span class="badge badge-expense">Expense</span>{% endif %}</td>
        <td class="p-2">{{ t.category }}</td>
        <td class="p-2 font-medium {% if t.type == 'income' %}text-green-600{% else %}text-red-600{% endif %}">{{ t.amount }}</td>
        <td class="p-2 truncate max-w-xs">{{ t.notes|default:'-' }}</td>
        <td class="p-2 space-x-2"><a href="/transactions/{{ t.id }}/edit/" class="text-blue-600">Edit</a><a href="/transactions/{{ t.id }}/delete/" class="text-red-600">Delete</a></td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="p-4 text-center text-slate-500">No transactions found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  <div class="p-4 flex justify-between items-center text-sm">
    <div>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</div>
    <div class="space-x-2">
      {% if page_obj.has_previous %}<a class="px-2 py-1 border rounded" href="?page={{ page_obj.previous_page_number }}">Prev</a>{% endif %}
      {% if page_obj.has_next %}<a class="px-2 py-1 border rounded" href="?page={{ page_obj.next_page_number }}">Next</a>{% endif %}
    </div>
  </div>
</div>
{% endblock %}
